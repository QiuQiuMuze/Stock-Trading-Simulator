# 中国股市模拟交易平台

一个基于 FastAPI + 原生前端的全功能炒股模拟器骨架，实现中国 A 股市场的开盘/收盘节奏、涨跌停限制、随机波动行情以及基础交易功能。每个用户初始拥有 100,000 元人民币，可通过网页界面查看实时行情、走势图并执行买卖操作。

## 功能亮点

- ✅ **自动行情引擎**：模拟两段式交易时段（09:30-11:30、13:00-15:00），自动开闭市并限制每日涨跌幅 ±10%。
- ✅ **随机 10-20 只中国热门股票**：每次服务启动时随机选择公司并初始化价格。
- ✅ **实时推送**：通过 WebSocket 推送最新行情及市场状态，前端即时刷新表格和价格颜色（红涨绿跌）。
- ✅ **交互式走势图**：使用 Chart.js 绘制分时价格曲线，可随行点击股票切换。
- ✅ **模拟账户系统**：前端自动生成用户会话，每个账户初始 10 万元资金，支持买入/卖出、持仓与交易历史展示。

## 快速开始

1. **安装依赖**

   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows 使用 .venv\Scripts\activate
   pip install -r requirements.txt
   ```

2. **运行服务**

   ```bash
   uvicorn app.main:app --reload
   ```

3. 浏览器访问 [http://localhost:8000](http://localhost:8000)，即可体验实时行情和交易模拟。

## 可选配置

通过环境变量可调节模拟节奏：

| 变量名 | 说明 | 默认值 |
| ------ | ---- | ------ |
| `SIMULATION_SPEED` | 行情刷新速度倍数，>1 表示更快推送 | `1.0` |
| `MARKET_TICK_SECONDS` | 行情引擎基础刷新间隔（秒） | `2.0` |
| `FORCE_MARKET_OPEN` | 设为 `1` 时强制保持开市，便于演示 | `0` |

## 项目结构

```
app/
  main.py          # FastAPI 入口，API 与 WebSocket
  market.py        # 行情与账户模拟核心逻辑
  models.py        # Pydantic 数据模型
static/
  css/style.css    # 页面样式（红涨绿跌、暗色主题）
  js/app.js        # 前端逻辑：行情订阅、表格渲染、交易提交
templates/
  index.html       # 主界面模板
```

## 后续扩展建议

- 增加 K 线、成交量等更多图表类型
- 接入数据库存储账户与行情历史
- 引入登录系统或多角色权限
- 完善委托撮合与撮合成交回报

> ⚠️ 本项目仅用于教学与演示目的，所有数据均为随机模拟，不构成任何投资建议。
